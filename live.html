<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Market Pulse Dashboard</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="page">
      <header class="hero">
        <div>
          <p class="eyebrow">Live markets</p>
          <h1>Market Pulse Dashboard</h1>
          <p class="subtitle">
            Monitor the live watchlist, filter by sector and signal strength, and jump straight into
            a fresh trade analysis.
          </p>
          <p class="meta">
            Quotes refresh automatically based on market session and fall back to cached or historical
            data when live feeds are unavailable.
          </p>
          <a class="hero-link" href="./index.html">Back to Trade Analysis</a>
        </div>
        <div class="hero-card">
          <h2>Quick actions</h2>
          <ul>
            <li>Filter by sector, cap size, and signal.</li>
            <li>Sort by momentum and signal score.</li>
            <li>Analyze any symbol in one click.</li>
          </ul>
        </div>
      </header>

      <section class="market-card">
        <div class="market-header">
          <div>
            <p class="eyebrow">Live prices</p>
            <h2>Market pulse board</h2>
            <p class="subtitle">
              Track live prices across the watchlist and refine results with detailed filters.
            </p>
            <label class="auto-run-toggle">
              <input type="checkbox" id="auto-run-toggle" checked />
              Auto-run analysis on click
            </label>
          </div>
          <div class="refresh-pill">
            <span class="dot"></span>
            <span id="refresh-status">Updating…</span>
          </div>
        </div>
        <div class="market-indicator" id="market-indicator">
          <div class="market-indicator-group">
            <span class="market-indicator-label">Market Status</span>
            <span id="market-open-text">Closed</span>
            <span id="market-session-badge" class="session-badge closed">CLOSED</span>
          </div>
          <div class="market-indicator-group">
            <span class="market-indicator-label">Data Freshness</span>
            <span id="market-as-of">As of unknown UTC</span>
            <span id="market-source-badge" class="session-badge closed">HISTORICAL</span>
          </div>
          <span id="market-cache-note" class="market-indicator-note hidden">Using cached data</span>
        </div>

        <div class="watchlist-controls">
          <label class="watchlist-input">
            Add symbol
            <div class="watchlist-input-row">
              <input type="text" id="watchlist-input" placeholder="e.g. TSLA" />
              <button type="button" id="watchlist-add-button" class="primary-button">Add</button>
            </div>
            <p class="field-error hidden" id="watchlist-error" role="status" aria-live="polite"></p>
          </label>
          <label class="favorites-toggle">
            <input type="checkbox" id="filter-favorites" />
            Show favorites only
          </label>
        </div>

        <div class="filters">
          <label>
            Search symbol
            <input type="text" id="filter-search" placeholder="e.g. TSLA" />
          </label>
          <label>
            Sector
            <select id="filter-sector">
              <option value="all" selected>All sectors</option>
              <option value="Technology">Technology</option>
              <option value="Finance">Finance</option>
              <option value="Healthcare">Healthcare</option>
              <option value="Consumer">Consumer</option>
              <option value="Energy">Energy</option>
            </select>
          </label>
          <label>
            Market cap
            <select id="filter-cap">
              <option value="all" selected>All caps</option>
              <option value="Large">Large</option>
              <option value="Mid">Mid</option>
              <option value="Small">Small</option>
            </select>
          </label>
          <label>
            Signal
            <select id="filter-signal">
              <option value="all" selected>All signals</option>
              <option value="buy">Buy</option>
              <option value="hold">Hold</option>
              <option value="sell">Sell</option>
            </select>
          </label>
          <label>
            Min price
            <input type="number" id="filter-min" min="0" step="0.01" placeholder="0" />
          </label>
          <label>
            Max price
            <input type="number" id="filter-max" min="0" step="0.01" placeholder="500" />
          </label>
          <label>
            Min 1M change %
            <input type="number" id="filter-month" step="0.1" placeholder="0" />
          </label>
        </div>

        <section class="opportunities-card" id="top-opportunities">
          <div class="opportunities-header">
            <div>
              <p class="eyebrow">Top opportunities today</p>
              <h3>Top opportunities today</h3>
            </div>
            <label class="opportunities-toggle">
              <input type="checkbox" id="opportunities-toggle" checked />
              Show Top opportunities
            </label>
          </div>
          <div class="opportunities-content" id="opportunities-content">
            <div class="opportunities-grid">
              <article class="opportunity-card" data-group="buy">
                <div class="opportunity-card-header">
                  <div class="opportunity-title">
                    <span>Top BUY</span>
                    <span class="signal-pill buy">BUY</span>
                  </div>
                </div>
                <div class="opportunity-list" id="opportunity-buy-list"></div>
                <p class="opportunity-note hidden" id="opportunity-buy-note">Not enough matches.</p>
              </article>
              <article class="opportunity-card" data-group="sell">
                <div class="opportunity-card-header">
                  <div class="opportunity-title">
                    <span>Top SELL</span>
                    <span class="signal-pill sell">SELL</span>
                  </div>
                </div>
                <div class="opportunity-list" id="opportunity-sell-list"></div>
                <p class="opportunity-note hidden" id="opportunity-sell-note">Not enough matches.</p>
              </article>
              <article class="opportunity-card" data-group="movers">
                <div class="opportunity-card-header">
                  <div class="opportunity-title">
                    <span>Top Movers 1D</span>
                    <span class="badge">1D</span>
                  </div>
                </div>
                <div class="opportunity-list" id="opportunity-movers-list"></div>
                <p class="opportunity-note hidden" id="opportunity-movers-note">Not enough matches.</p>
              </article>
            </div>
          </div>
        </section>

        <div class="market-table">
          <table>
            <colgroup>
            <col data-col="favorite" style="width: 50px" />
            <col data-col="symbol" style="width: 80px" />
            <col data-col="company" style="width: 160px" />
            <col data-col="sector" style="width: 110px" />
            <col data-col="cap" style="width: 85px" />
            <col data-col="signal" style="width: 80px" />
            <col data-col="horizon" style="width: 100px" />
            <col data-col="price" style="width: 150px" />
            <col data-col="perf" style="width: 260px" />
            <col data-col="actions" style="width: 160px" />
          </colgroup>
          <thead>
            <tr>
              <th data-col="favorite">Fav</th>
              <th data-col="symbol">Symbol</th>
              <th data-col="company">Company</th>
              <th data-col="sector">Sector</th>
              <th data-col="cap">Market cap</th>
              <th data-col="signal">Signal</th>
              <th data-col="horizon">Time horizon</th>
              <th data-col="price" class="num-cell">Live price</th>
              <th data-col="perf">Performance</th>
              <th data-col="actions">Actions</th>
            </tr>
          </thead>
            <tbody id="market-body"></tbody>
          </table>
        </div>
      </section>
    </main>
    <div id="signal-drawer-overlay" class="drawer-overlay hidden"></div>
    <aside
      id="signal-drawer"
      class="signal-drawer hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="drawer-symbol"
      aria-hidden="true"
      tabindex="-1"
    >
      <div class="drawer-header">
        <div>
          <p class="eyebrow">Signal details</p>
          <div class="drawer-title-row">
            <span id="drawer-action" class="signal-pill hold">HOLD</span>
            <h2 id="drawer-symbol">—</h2>
          </div>
          <div class="drawer-badges">
            <span id="drawer-session-badge" class="session-badge closed">CLOSED</span>
            <span id="drawer-source-badge" class="session-badge closed">HISTORICAL</span>
            <span id="drawer-as-of" class="drawer-as-of">As of —</span>
          </div>
        </div>
        <button type="button" id="signal-drawer-close" class="icon-button drawer-close" aria-label="Close signal drawer">
          ✕
        </button>
      </div>
      <div id="signal-drawer-skeleton" class="drawer-skeleton hidden" aria-hidden="true">
        <div class="skeleton-line skeleton-title"></div>
        <div class="skeleton-line"></div>
        <div class="skeleton-line"></div>
        <div class="skeleton-line skeleton-block"></div>
        <div class="skeleton-line skeleton-block"></div>
        <div class="skeleton-line"></div>
        <div class="skeleton-line"></div>
      </div>
      <div id="signal-drawer-error" class="drawer-error hidden" role="status" aria-live="polite">
        <p>Unable to load signal details right now.</p>
        <button type="button" id="signal-drawer-retry" class="primary-button">Retry</button>
      </div>
      <div id="signal-drawer-body" class="drawer-body hidden">
        <section class="drawer-section">
          <h3>Score &amp; confidence</h3>
          <div class="drawer-stats">
            <div>
              <span class="drawer-label">Signal score</span>
              <span id="drawer-score" class="drawer-value">—</span>
            </div>
            <div>
              <span class="drawer-label">Confidence</span>
              <span id="drawer-confidence" class="drawer-value">—</span>
            </div>
          </div>
        </section>
        <section class="drawer-section">
          <h3>Trade plan</h3>
          <dl class="drawer-plan">
            <div class="drawer-plan-row">
              <dt>Entry</dt>
              <dd id="drawer-entry">—</dd>
            </div>
            <div class="drawer-plan-row" id="drawer-stop-row">
              <dt>Stop</dt>
              <dd id="drawer-stop">—</dd>
            </div>
            <div class="drawer-plan-row" id="drawer-take-profit-row">
              <dt>Take profit</dt>
              <dd id="drawer-take-profit">—</dd>
            </div>
            <div class="drawer-plan-row">
              <dt>Position size</dt>
              <dd id="drawer-position">—</dd>
            </div>
          </dl>
        </section>
        <section class="drawer-section">
          <h3>Reasoning</h3>
          <ul id="drawer-reasoning"></ul>
        </section>
        <section class="drawer-section">
          <h3>Invalidation rules</h3>
          <ul id="drawer-invalidation"></ul>
        </section>
        <section class="drawer-section" id="drawer-backtest">
          <h3>Backtest snapshot</h3>
          <p id="drawer-backtest-status" class="muted"></p>
          <dl id="drawer-backtest-list" class="drawer-plan hidden">
            <div class="drawer-plan-row">
              <dt>Trades</dt>
              <dd id="drawer-backtest-trades">—</dd>
            </div>
            <div class="drawer-plan-row">
              <dt>Win rate</dt>
              <dd id="drawer-backtest-win-rate">—</dd>
            </div>
            <div class="drawer-plan-row">
              <dt>Avg return</dt>
              <dd id="drawer-backtest-avg-return">—</dd>
            </div>
            <div class="drawer-plan-row">
              <dt>Max drawdown</dt>
              <dd id="drawer-backtest-drawdown">—</dd>
            </div>
            <div class="drawer-plan-row">
              <dt>Buy &amp; hold</dt>
              <dd id="drawer-backtest-buy-hold">—</dd>
            </div>
          </dl>
        </section>
        <a id="drawer-open-full" class="primary-button" href="#">Open full analysis page</a>
      </div>
    </aside>
    <script src="core.js"></script>
    <script src="live.js"></script>
  </body>
</html>
